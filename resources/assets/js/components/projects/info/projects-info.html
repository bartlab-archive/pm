<div layout="row" layout-align="center start">
    <md-card flex-xs="100" flex-sm="100" flex-md="70" flex-gt-md="50">
        <md-card-title>
            <md-card-title-text>
                <span class="md-headline">Overview</span>
                <span class="md-subhead" ng-if="$ctrl.project.homepage">
                    <md-icon>open_in_new</md-icon>
                    <a href="{{ $ctrl.project.homepage }}" target="_blank">{{ $ctrl.project.homepage }}</a>
                </span>
            </md-card-title-text>
        </md-card-title>

        <md-card-content class="md-body-1" markdown-to-html="$ctrl.project.description || ''"></md-card-content>
    </md-card>
</div>

<div layout="row" layout-align="center start" ng-if="$ctrl.canShowModule('issue_tracking')">
    <md-card flex-xs="100" flex-sm="100" flex-md="70" flex-gt-md="50">
        <md-card-title>
            <md-card-title-text>
                <span class="md-headline">Issue tracking</span>
            </md-card-title-text>
        </md-card-title>

        <md-card-content class="md-body-1">
            <p ng-repeat="(trackerName, issue)  in $ctrl.issuesCount">
                {{trackerName}}: {{issue.opened}} | {{issue.closed}} | {{issue.closed + issue.opened}}
            </p>
        </md-card-content>

        <md-card-actions layout="row" layout-align="center center">
            <md-button ui-sref="projects-inner.issues.index" ng-click="$ctrl.issueNavigate()">View all issues
            </md-button>
            <md-button ui-sref="projects-inner.issues.calendar" ng-if="canShowModule('calendar')">Calendar</md-button>
            <md-button ui-sref="projects-inner.issues.gantt">Gantt</md-button>
        </md-card-actions>
    </md-card>
</div>

<div layout="row" layout-align="center start">
    <md-card flex-xs="100" flex-sm="100" flex-md="70" flex-gt-md="50">
        <md-card-title>
            <md-card-title-text>
                <span class="md-headline">Members</span>
            </md-card-title-text>
        </md-card-title>

        <md-card-content class="md-body-1">
            <p ng-repeat="(role, members) in $ctrl.membersByRole">
                {{role}}:
                <a ng-repeat="(userId, name) in members" ui-sref="users.info({id: userId})">{{name}}</a>
            </p>
        </md-card-content>
    </md-card>
</div>

<div layout="row" layout-align="center start" ng-if="$ctrl.canShowModule('news')">
    <md-card flex-xs="100" flex-sm="100" flex-md="70" flex-gt-md="50">
        <md-card-title>
            <md-card-title-text>
                <span class="md-headline">Latest news</span>
            </md-card-title-text>
        </md-card-title>

        <md-card-content class="md-body-1">
            <div ng-repeat="news in $ctrl.project.news">
                <md-button class="md-secondary"
                           ng-click="$ctrl.$state.go('news.index', {id: news.id})">
                    {{news.title}}
                </md-button>

                Added by
                <md-button class="md-secondary"
                           ng-click="$ctrl.userNavigate(news.author_id)">
                    {{$ctrl.members[news.author_id].name}}
                </md-button>
                <md-button class="md-secondary"
                           ng-click="$ctrl.$state.go('projects.inner.activity', {from: news.created_on, project_id: $ctrl.project.identifier})">
                    {{$ctrl.IssuesService.timeAgo(news.created_on)}}
                </md-button>
                ago
            </div>
        </md-card-content>
        <md-card-actions layout="row" layout-align="center center">
            <md-button ng-click="$ctrl.$state.go('projects.inner.news', {project_id: $ctrl.project.identifier})">View all news</md-button>
        </md-card-actions>
    </md-card>
</div>

<div layout="row" layout-align="center start" ng-if="_.isEmpty($ctrl.project.child_projects)">
    <md-card flex-xs="100" flex-sm="100" flex-md="70" flex-gt-md="50">
        <md-card-title>
            <md-card-title-text>
                <span class="md-headline">Subprojects</span>
            </md-card-title-text>
        </md-card-title>

        <md-card-content class="md-body-1">
            <md-button class="md-secondary"
                       ng-repeat="subProject in $ctrl.project.child_projects"
                       ng-click="$ctrl.projectNavigate(subProject.identifier)">
                {{subProject.name}}
            </md-button>
        </md-card-content>
    </md-card>
</div>